<section ng-controller="MemberFormCntrl">

<form class="mt-3" name="memberForm" novalidate ng-submit="saveOrUpdateMember()">

  <!-- Basic Member Information -->
  <fieldset class="mb-4">
    <legend>{{i18n.forms.member.legend}}</legend>

    <!-- Name row -->
    <div class="form-row">
      <div class="col-sm form-group">
        <label for="fname">
          {{i18n.forms.member.fnameLbl}}
        </label>
        <input type="text" id="fname" name="fname" class="form-control form-control-lg"
          placeholder="{{i18n.forms.member.fnameHint}}" ng-model="member.firstname" ng-required="true">
      </div>
      <div class="col-sm form-group">
        <label for="lname">
          {{i18n.forms.member.lnameLbl}}
        </label>
        <input type="text" id="lname" name="lname" class="form-control form-control-lg"
          placeholder="{{i18n.forms.member.lnameHint}}" ng-model="member.lastname" ng-required="true">
      </div>
    </div>

    <!-- Shortname and Bday -->
    <div class="form-row">
      <div class="col-sm form-group">
        <label for="sname">
          {{i18n.forms.member.snameLbl}}
        </label>
        <input type="text" id="sname" name="sname" class="form-control form-control-lg"
          placeholder="{{i18n.forms.member.snameHint}}" ng-model="member.shortname" ng-required="true">
      </div>
      <div class="col-sm form-group">
        <label for="bday">
          {{i18n.forms.member.bdayLbl}}
        </label>
        <input type="date" id="bday" name="bday" min="{{config.bday.minDate}}" max="{{config.bday.maxDate}}"
          class="form-control form-control-lg" placeholder="{{i18n.forms.member.bdayHint}}"
          ng-model="member.bday" ng-required="false">
      </div>
    </div>

    <!-- Email and Phone Row -->
    <div class="form-row">
      <div class="col-sm form-group">
        <label for="phone">
          {{i18n.forms.phone.phoneLbl}}
        </label>
        <input type="tel" id="phone" name="phone" class="form-control form-control-lg"
          placeholder="{{i18n.forms.phone.phoneHint}}" ng-model="member.phone" ng-required="!(member.email)">
      </div>
      <div class="col-sm form-group">
        <label for="email">
          {{i18n.forms.member.emailLbl}}
        </label>
        <input type="email" id="email" name="email" class="form-control form-control-lg"
        placeholder="{{i18n.forms.member.emailHint}}" ng-model="member.email" ng-required="!(member.phone)">
      </div>
      <div class="col-sm form-group" ng-if="currentSession.user.type == 'admin' && member.email">
        <label>{{i18n.forms.member.canBeUserLbl}}</label>
        <input type="hidden" name="canBeUser" ng-model="member.canBeUser">
        <button type="button" class="btn btn-lg btn-block btn-primary" ng-if="member.canBeUser" ng-click="member.canBeUser = false">
          {{i18n.btns.yesBtn}}
        </button>
        <button type="button" class="btn btn-lg btn-block btn-warning" ng-if="!member.canBeUser" ng-click="member.canBeUser = true">
          {{i18n.btns.noBtn}}
        </button>
      </div>
    </div>

    <!-- Group and Status Row -->
    <div class="form-row" ng-if="currentSession.user.type == 'admin'">
      <div class="col-sm form-group">
        <label for="baseGroup">
          {{i18n.forms.member.baseGroupLbl}}
        </label>
        <select id="baseGroup" class="form-control form-control-lg" ng-model="member.baseGroup" ng-required="true">
          <option ng-repeat="g in groupsList" value="{{g.$id}}" >
            {{g.group.name}}
          </option>
        </select>
      </div>
      <div class="col-sm form-group">
        <label for="status">
          {{i18n.dropdowns.status.label}}
        </label>
        <select id="status" name="status" class="form-control form-control-lg"
                ng-model="member.status" ng-required="true">
          <option value="active">{{i18n.dropdowns.status.active}}</option>
          <option value="inactive">{{i18n.dropdowns.status.inactive}}</option>
        </select>
      </div>
    </div>

    <div class="form-row" ng-if="currentSession.user.type == 'admin'">
      <div class="col-sm form-group">
        <label>{{i18n.forms.member.isHostLbl}}</label>
        <input type="hidden" ng-model="member.isHost">
        <button type="button" class="btn btn-lg btn-block btn-primary" ng-if="member.isHost" ng-click="member.isHost = false">
          {{i18n.btns.yesBtn}}
        </button>
        <button type="button" class="btn btn-lg btn-block btn-warning" ng-if="!member.isHost" ng-click="member.isHost = true">
          {{i18n.btns.noBtn}}
        </button>
      </div>
      <div class="col-sm form-group">
        <label>{{i18n.forms.member.isLeadLbl}}</label>
        <input type="hidden" ng-model="member.isLeader">
        <button type="button" class="btn btn-lg btn-block btn-primary" ng-if="member.isLeader" ng-click="member.isLeader = false">
          {{i18n.btns.yesBtn}}
        </button>
        <button type="button" class="btn btn-lg btn-block btn-warning" ng-if="!member.isLeader" ng-click="member.isLeader = true">
          {{i18n.btns.noBtn}}
        </button>
      </div>
      <div class="col-sm form-group">
        <label>{{i18n.forms.member.isTraineeLbl}}</label>
        <input type="hidden" ng-model="member.isTrainee">
        <button type="button" class="btn btn-lg btn-block btn-primary" ng-if="member.isTrainee" ng-click="member.isTrainee = false">
          {{i18n.btns.yesBtn}}
        </button>
        <button type="button" class="btn btn-lg btn-block btn-warning" ng-if="!member.isTrainee" ng-click="member.isTrainee = true">
          {{i18n.btns.noBtn}}
        </button>
      </div>
    </div>
  </fieldset>

  <!-- Address -->
  <article ng-include="'views/fragments/addressFieldset.html'"></article>
  <div class="form-row">
    <div class="col-sm form-group" >
      <button type="button" class="btn btn-lg btn-primary"
        ng-show="!provideAddress" ng-click="provideAddress = !provideAddress">
        {{i18n.btns.provideAddress}}
      </button>
      <button type="button" class="btn btn-lg btn-warning"
        ng-show="provideAddress" ng-click="provideAddress = !provideAddress">
        {{i18n.btns.notProvideAddress}}
      </button>
    </div>
  </div>

  <!-- Alert/Error row -->
  <div class="form-row">
    <div class="col">
      <div class="alert alert-warning" role="alert" ng-show="memberForm.$invalid && memberForm.$dirty">
        {{i18n.alerts.invalidForm}}
      </div>
      <div class="alert alert-success" role="alert" ng-show="response.memberMsgOk">
        {{response.memberMsgOk}}
      </div>
      <div class="alert alert-danger" role="alert" ng-show="response.memberMsgError">
        {{response.memberMsgError}}
      </div>
    </div>
  </div>

  <!-- Buttons rows -->
  <div class="form-row">
    <div class="col-sm form-group" >
      <button type="submit" class="btn btn-lg btn-block btn-success"
        ng-disabled="memberForm.$invalid">
        {{i18n.btns.saveBtn}}
      </button>
    </div>
    <div class="col-sm form-group" ng-if="memberId">
      <button type="button" class="btn btn-lg btn-block btn-danger"
          data-toggle="collapse" data-target="#collapseDelete" aria-expanded="false" aria-controls="collapseDelete">
        {{i18n.btns.deleteBtn}}
      </button>
      <div  class="collapse" id="collapseDelete">
        <div class="alert alert-danger" role="alert">
          {{i18n.alerts.confirmDelete}}
          <button type="button" class="btn btn-danger" ng-click="deleteMember()">
            {{i18n.btns.yesBtn}}
          </button>
          <button type="button" class="btn btn-success" data-toggle="collapse" data-target="#collapseDelete" aria-expanded="false" aria-controls="collapseDelete">
            {{i18n.btns.noBtn}}
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="form-row">
    <div class="col form-group">
      <a class="btn btn-lg btn-block btn-primary" href="#!/members">
        {{i18n.btns.returnBtn}}
      </a>
    </div>
  </div> -->

</form>

</section>
